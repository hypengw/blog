<!doctype html><html lang=en dir=auto data-theme=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Is Flatpak a Package Manager | Bluempty</title><meta name=keywords content="Technology,Linux"><meta name=description content="
Reading this article requires some understanding of: Linux distributions, Linux Desktop Environment, Package Manager

My first encounter with Linux was in high school, when there seemed to be a software that only had a Linux version, so I tried to install Arch by following online articles. I don&rsquo;t remember the specific details anymore.
For me at that time, a bunch of incomprehensible commands were quite a headache, and I was always afraid of breaking my computer."><meta name=author content="hypengw"><link rel=canonical href=https://blog.bluempty.com/en/post/is-flatpak-package-manager/><link crossorigin=anonymous href=/assets/css/stylesheet.da3211e5ef867bf2b75fd5a6515cfed7195c011e8ab735694e203810a827097b.css integrity="sha256-2jIR5e+Ge/K3X9WmUVz+1xlcAR6KtzVpTiA4EKgnCXs=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.bluempty.com/images/profile.webp><link rel=icon type=image/png sizes=16x16 href=https://blog.bluempty.com/images/profile.webp><link rel=icon type=image/png sizes=32x32 href=https://blog.bluempty.com/images/profile.webp><link rel=apple-touch-icon href=https://blog.bluempty.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.bluempty.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=zh href=https://blog.bluempty.com/post/is-flatpak-package-manager/><link rel=alternate hreflang=en href=https://blog.bluempty.com/en/post/is-flatpak-package-manager/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51);color-scheme:dark}.list{background:var(--theme)}.toc{background:var(--entry)}}@media(prefers-color-scheme:light){.list::-webkit-scrollbar-thumb{border-color:var(--code-bg)}}</style></noscript><script>localStorage.getItem("pref-theme")==="dark"?document.querySelector("html").dataset.theme="dark":localStorage.getItem("pref-theme")==="light"?document.querySelector("html").dataset.theme="light":window.matchMedia("(prefers-color-scheme: dark)").matches?document.querySelector("html").dataset.theme="dark":document.querySelector("html").dataset.theme="light"</script><link rel=stylesheet href=/css/dimbox.min.css><meta property="og:url" content="https://blog.bluempty.com/en/post/is-flatpak-package-manager/"><meta property="og:site_name" content="Bluempty"><meta property="og:title" content="Is Flatpak a Package Manager"><meta property="og:description" content=" Reading this article requires some understanding of: Linux distributions, Linux Desktop Environment, Package Manager
My first encounter with Linux was in high school, when there seemed to be a software that only had a Linux version, so I tried to install Arch by following online articles. I don‚Äôt remember the specific details anymore. For me at that time, a bunch of incomprehensible commands were quite a headache, and I was always afraid of breaking my computer."><meta property="og:locale" content="en-us"><meta property="og:type" content="article"><meta property="article:section" content="post"><meta property="article:published_time" content="2025-01-03T21:25:18+08:00"><meta property="article:modified_time" content="2025-01-03T21:25:18+08:00"><meta property="article:tag" content="Technology"><meta property="article:tag" content="Linux"><meta name=twitter:card content="summary"><meta name=twitter:title content="Is Flatpak a Package Manager"><meta name=twitter:description content="
Reading this article requires some understanding of: Linux distributions, Linux Desktop Environment, Package Manager

My first encounter with Linux was in high school, when there seemed to be a software that only had a Linux version, so I tried to install Arch by following online articles. I don&rsquo;t remember the specific details anymore.
For me at that time, a bunch of incomprehensible commands were quite a headache, and I was always afraid of breaking my computer."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.bluempty.com/en/post/"},{"@type":"ListItem","position":2,"name":"Is Flatpak a Package Manager","item":"https://blog.bluempty.com/en/post/is-flatpak-package-manager/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Is Flatpak a Package Manager","name":"Is Flatpak a Package Manager","description":" Reading this article requires some understanding of: Linux distributions, Linux Desktop Environment, Package Manager\nMy first encounter with Linux was in high school, when there seemed to be a software that only had a Linux version, so I tried to install Arch by following online articles. I don\u0026rsquo;t remember the specific details anymore. For me at that time, a bunch of incomprehensible commands were quite a headache, and I was always afraid of breaking my computer.\n","keywords":["Technology","Linux"],"articleBody":" Reading this article requires some understanding of: Linux distributions, Linux Desktop Environment, Package Manager\nMy first encounter with Linux was in high school, when there seemed to be a software that only had a Linux version, so I tried to install Arch by following online articles. I don‚Äôt remember the specific details anymore. For me at that time, a bunch of incomprehensible commands were quite a headache, and I was always afraid of breaking my computer.\nDuring university, I used a dual-boot system for a while. In daily use, the Linux system was particularly prone to ‚Äúbreaking‚Äù, and the reasons were varied and bizarre. Looking at it layer by layer, hardware compatibility/kernel/drivers/system libraries/dependencies/desktop environment, etc., could all have bugs. These components are also somewhat disconnected from each other, so problems are common. Occasionally solving one or two problems gives a sense of accomplishment, but too many just feel purely troublesome.\nThere‚Äôs a specific example that made me want to laugh while also relating deeply: Linus Tech uninstalled his desktop environment while trying to install Steam.\nIn 2020, I accidentally came across Flatpak, and within a short time, I went all-in with Flatpak for my daily software. Later, I also maintained several software packages I wanted to use on Flathub. In terms of daily experience, I no longer have to worry about software not working after updates, don‚Äôt need to manually manage software updates, no longer worry about unruly closed-source software, and no longer worry that system updates will break my main software.\nAfter using Flatpak, I decided to make Linux Desktop my primary system.\nWhat Problems Does Flatpak Solve First and foremost, decoupling from the system. This specifically solves the problem that Linus Tech encountered above. Actually, something similar has existed on servers for quite a while, namely containers, that is, the Docker ecosystem. Friends who have been exposed to Linux distributions should be particularly familiar with package management, along with concepts like dependencies, repositories, source code, packages, FHS, etc., though we won‚Äôt discuss how this system specifically works here.\nLet‚Äôs look at how Linus Tech accidentally damaged his desktop environment. The installation command was sudo apt-get install steam, followed by a large output, which included a warning WARNING: The following essential packages will be removed, and this included pop-desktop, which ultimately led to the desktop environment being uninstalled. Some people would point out that this is because Linus Tech was unfamiliar, or that the installation guide and critical package protection weren‚Äôt handled well, or that it‚Äôs a problem with package management, or that using Linux as a desktop system is just stupid and deserved.\nLooking beyond the phenomenon to the key issue, first, installing user software requires sudo. There‚Äôs a good analogy, which is UAC in Windows systems. Friends who frequently use Windows systems must have heard the term reinstalling the system, right? So why do you need to reinstall your system from time to time? A major factor is that most of the software you use daily requests UAC to install or run. To use a car analogy, an originally good car, in order to add certain features, is sent to a modification shop. The shop people can certainly implement this feature, but this doesn‚Äôt prevent them from installing some extra things on the car or replacing critical parts. After multiple modifications, the car gradually breaks down.\nSecond, apt-get manages both user software and system components simultaneously. In my view, dependency management is a complex system problem. The chaotic dependency relationships between software packages, with each node in the relationship network frequently updating itself, it‚Äôs not difficult to conclude that the uncertainty here increases nearly exponentially with the number of packages. There‚Äôs also an example of this: occasionally seeing developers who use npm complaining about node_modules is particularly interesting.\nHere I clearly distinguish between user software and system components. System components are few in number, change slowly and are stable, and are mostly depended upon - these characteristics perfectly fit package management. User software, on the other hand, is numerous and diverse, changes rapidly and can die at any time, depends on a large number of libraries - this completely steps on package management‚Äôs landmines. When we try to integrate these two types of packages together, system components being ‚Äúblown up‚Äù by some user software is to be expected.\nSecondly, it introduces sandboxing. There‚Äôs no need to say much about what problem this solves. In recent years, both Microsoft and Google have been tightening permissions for user software on their respective systems. Users in China are also slowly becoming aware of privacy and security-related concepts.\nThen there‚Äôs unification. As everyone knows, Linux distributions are quite fragmented, even more fragmented than Android. I personally switched from arch to debian to opensuse back to debian and finally settled on fedora, and there are countless niche within niche distributions, while these distributions also have version fragmentation similar to Android. Then you also have to factor in desktop environment fragmentation: gnome/kde/cosmic/xfce/lxqt/.... This fragmentation brings a terrible user experience and has discouraged many developers.\nFinally, from the developer‚Äôs perspective, there have always been two contradictory points.\nFirst is the difference in system environment between developers and users, which is a fragmentation problem, but it has given Linux users a bad reputation, such as the common saying: the smallest number of users, but the most issues reported.\nSecond is with distributions, where the core contradiction lies in different requirements for dependency versions between distributions and developers. Distributions need a certain component to stay at the latest version or not update major versions, only updating security patches. Developers have one requirement: use the same dependency versions as the development environment.\nHow Does Flatpak Solve These Runtime The runtime encompasses most common base libraries, such as glibc, libstdc++, libcurl, xorg suite, wayland suite, etc. Version numbers like 23.08/24.08, with one major update per year to introduce breaking changes, while regular maintenance ensures ABI compatibility. Libraries not in the runtime are bundled by the software itself, and libraries with the same name prioritize loading the bundled version. Similar to the Win/Android approach. Runtime is divided into Platform and SDK. Simply put, Platform is derived from SDK by removing header files, static libraries, compilation toolchains, etc. Now that the basic situation is explained, some people may wonder why not directly use the host‚Äôs libraries, which would save more space.\nDecoupling from the system - not depending on or assuming the host system‚Äôs libraries, so that even an ancient Debian oldstable can use the latest libraries and software. This also greatly solves the distribution fragmentation problem.\nFor developers, a determined runtime environment, the freedom to decide dependency library versions, allows more energy to be focused on developing software.\nbubblewrap Isolation An unprivileged sandbox implemented through Linux namespaces, details can be found on the project homepage.\nIt ensures that, with specified limited permissions, flatpak applications are isolated from the host environment.\nPortal (xdp) After isolating the host environment, we need a set of verified IPC interfaces to manage some sensitive host resources.\nYou can refer to Android permissions, though Android is based on binder, while xdp is based on dbus.\nWhat‚Äôs quite interesting is that xdp has indirectly unified the chaotic desktop environment interfaces of Linux desktop. qt/gtk/electron/... have all now adapted to xdp.\nIs Flatpak a Package Manager Back to the article‚Äôs title, is Flatpak a package management tool? I don‚Äôt think so.\nOur definition of package management is generally limited to software within Linux distributions that satisfies certain functions. Flatpak has many similarities with these software, but the approach is completely different. Most importantly, Flatpak cannot replace traditional package management; it‚Äôs more of a supplement, returning package management to the role of ‚Äúmanaging system software packages‚Äù. Flatpak packages have very coarse granularity and unusually shallow dependency relationships, unable to build/operate fine components in distributions. For example, freedesktop sdk itself is not built through Flatpak but through BuildStream.\nHowever, this is actually an open question, and readers can judge for themselves.\nOr look at it from another angle, for example, is Android‚Äôs package installer a package manager?\nFlatpak Tips and Technical Details Runtime /app Let‚Äôs go into the runtime and take a specific look\n$ flatpak run --command=bash org.freedesktop.Sdk//24.08 [üì¶ org.freedesktop.Sdk ~]$ ls / app bin dev etc lib lib64 proc run sbin sys tmp usr var [üì¶ org.freedesktop.Sdk ~]$ cat /etc/ld.so.conf include /run/flatpak/ld.so.conf.d/app-*.conf include /app/etc/ld.so.conf /app/lib include /run/flatpak/ld.so.conf.d/runtime-*.conf [üì¶ org.freedesktop.Sdk ~]$ ldd /usr/bin/ls linux-vdso.so.1 (0x00007f4737637000) libselinux.so.1 =\u003e /usr/lib/x86_64-linux-gnu/libselinux.so.1 (0x00007f47375bd000) libc.so.6 =\u003e /usr/lib/x86_64-linux-gnu/libc.so.6 (0x00007f47373be000) libpcre2-8.so.0 =\u003e /usr/lib/x86_64-linux-gnu/libpcre2-8.so.0 (0x00007f473731d000) /lib64/ld-linux-x86-64.so.2 (0x00007f4737639000) [üì¶ org.freedesktop.Sdk ~]$ echo $PATH /app/bin:/usr/bin You can see that this is actually equivalent to a minimal distribution following FHS.\n/app As the Prefix for each software, during compilation and packaging, only this directory is writable. /app/lib Where software places bundled libraries /app/bin In the container‚Äôs PATH environment variable by default, the software‚Äôs startup program needs to be installed/linked here host share [üì¶ org.freedesktop.Sdk ~]$ echo $XDG_DATA_DIRS /app/share:/usr/share:/usr/share/runtime/share:/run/host/user-share:/run/host/share [üì¶ org.freedesktop.Sdk ~]$ cat /etc/fonts/conf.d/50-flatpak.conf \u003c?xml version=\"1.0\"?\u003e \u003c!DOCTYPE fontconfig SYSTEM \"fonts.dtd\"\u003e /usr/cache/fontconfig /app/share/fonts /app/cache/fontconfig ","wordCount":"1764","inLanguage":"en","datePublished":"2025-01-03T21:25:18+08:00","dateModified":"2025-01-03T21:25:18+08:00","author":{"@type":"Person","name":"hypengw"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.bluempty.com/en/post/is-flatpak-package-manager/"},"publisher":{"@type":"Organization","name":"Bluempty","logo":{"@type":"ImageObject","url":"https://blog.bluempty.com/images/profile.webp"}}}</script></head><body id=top><header class=header><nav class=nav><div class=logo><a href=https://blog.bluempty.com/en/ accesskey=h title="Bluempty (Alt + H)">Bluempty</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button><ul class=lang-switch><li>|</li><li><a href=https://blog.bluempty.com/ title=Zh aria-label=Zh>Zh</a></li></ul></div></div><ul id=menu><li><a href=https://blog.bluempty.com/en/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://blog.bluempty.com/en/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://blog.bluempty.com/en/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://blog.bluempty.com/en/friends/ title=Friends><span>Friends</span></a></li><li><a href=https://blog.bluempty.com/en/about/ title=About><span>About</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://blog.bluempty.com/en/>Home</a>&nbsp;¬ª&nbsp;<a href=https://blog.bluempty.com/en/post/>Posts</a></div><h1 class="post-title entry-hint-parent">Is Flatpak a Package Manager</h1><div class=post-meta><span title='2025-01-03 21:25:18 +0800 +0800'>January 3, 2025</span>&nbsp;¬∑&nbsp;<span>9 min</span>&nbsp;¬∑&nbsp;<span>hypengw</span>&nbsp;|&nbsp;<span>Translations:</span><ul class=i18n_list><li><a href=https://blog.bluempty.com/post/is-flatpak-package-manager/>Zh</a></li></ul></div></header><div class=toc><details open><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#what-problems-does-flatpak-solve aria-label="What Problems Does Flatpak Solve">What Problems Does Flatpak Solve</a></li><li><a href=#how-does-flatpak-solve-these aria-label="How Does Flatpak Solve These">How Does Flatpak Solve These</a><ul><li><a href=#runtime aria-label=Runtime>Runtime</a></li><li><a href=#bubblewrap-isolation aria-label="bubblewrap Isolation">bubblewrap Isolation</a></li><li><a href=#portal-xdp aria-label="Portal (xdp)">Portal (xdp)</a></li></ul></li><li><a href=#is-flatpak-a-package-manager aria-label="Is Flatpak a Package Manager">Is Flatpak a Package Manager</a></li><li><a href=#flatpak-tips-and-technical-details aria-label="Flatpak Tips and Technical Details">Flatpak Tips and Technical Details</a><ul><li><a href=#runtime-1 aria-label=Runtime>Runtime</a><ul><li><a href=#app aria-label=/app>/app</a></li><li><a href=#host-share aria-label="host share">host share</a></li></ul></li><li><a href=#global-permissions aria-label="Global Permissions">Global Permissions</a><ul><li><a href=#priority aria-label=Priority>Priority</a></li></ul></li><li><a href=#system-wide-and-per-user aria-label="system-wide and per-user">system-wide and per-user</a><ul><li><a href=#system-wide aria-label=system-wide>system-wide</a></li><li><a href=#per-user aria-label=per-user>per-user</a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><blockquote><p>Reading this article requires some understanding of: <code>Linux distributions</code>, <code>Linux Desktop Environment</code>, <code>Package Manager</code></p></blockquote><p>My first encounter with Linux was in high school, when there seemed to be a software that only had a Linux version, so I tried to install Arch by following online articles. I don&rsquo;t remember the specific details anymore.
For me at that time, a bunch of incomprehensible commands were quite a headache, and I was always afraid of breaking my computer.</p><p>During university, I used a dual-boot system for a while. In daily use, the Linux system was particularly prone to &ldquo;breaking&rdquo;, and the reasons were varied and bizarre. Looking at it layer by layer, hardware compatibility/kernel/drivers/system libraries/dependencies/desktop environment, etc., could all have bugs. These components are also somewhat disconnected from each other, so problems are common. Occasionally solving one or two problems gives a sense of accomplishment, but too many just feel purely troublesome.</p><p>There&rsquo;s a specific example that made me want to laugh while also relating deeply: <a href="https://www.youtube.com/watch?v=0506yDSgU7M">Linus Tech uninstalled his desktop environment while trying to install Steam</a>.</p><p>In 2020, I accidentally came across Flatpak, and within a short time, I went all-in with Flatpak for my daily software. Later, I also maintained several software packages I wanted to use on Flathub. In terms of daily experience, I no longer have to worry about software not working after updates, don&rsquo;t need to manually manage software updates, no longer worry about unruly closed-source software, and no longer worry that system updates will break my main software.</p><p><strong>After using Flatpak, I decided to make Linux Desktop my primary system</strong>.</p><h2 id=what-problems-does-flatpak-solve>What Problems Does Flatpak Solve<a hidden class=anchor aria-hidden=true href=#what-problems-does-flatpak-solve>#</a></h2><p>First and foremost, <strong>decoupling from the system</strong>. This specifically solves the problem that Linus Tech encountered above. Actually, something similar has existed on servers for quite a while, namely containers, that is, the Docker ecosystem. Friends who have been exposed to Linux distributions should be particularly familiar with <a href=https://en.wikipedia.org/wiki/Package_manager><strong>package management</strong></a>, along with concepts like <strong>dependencies</strong>, <strong>repositories</strong>, <strong>source code</strong>, <strong>packages</strong>, <a href=https://en.wikipedia.org/wiki/Filesystem_Hierarchy_Standard><strong>FHS</strong></a>, etc., though we won&rsquo;t discuss how this system specifically works here.</p><p>Let&rsquo;s look at how Linus Tech accidentally damaged his desktop environment. The installation command was <code>sudo apt-get install steam</code>, followed by a large output, which included a warning <code>WARNING: The following essential packages will be removed</code>, and this included <code>pop-desktop</code>, which ultimately led to the desktop environment being uninstalled. Some people would point out that this is because Linus Tech was unfamiliar, or that the installation guide and critical package protection weren&rsquo;t handled well, or that it&rsquo;s a problem with package management, or that using Linux as a desktop system is just stupid and deserved.</p><p>Looking beyond the phenomenon to the key issue, first, installing user software requires <code>sudo</code>. There&rsquo;s a good analogy, which is <a href=https://en.wikipedia.org/wiki/User_Account_Control>UAC</a> in Windows systems. Friends who frequently use Windows systems must have heard the term <em>reinstalling the system</em>, right? So why do you need to reinstall your system from time to time? A major factor is that most of the software you use daily requests UAC to install or run. To use a car analogy, an originally good car, in order to add certain features, is sent to a modification shop. The shop people can certainly implement this feature, but this doesn&rsquo;t prevent them from installing some extra things on the car or replacing critical parts. After multiple modifications, the car gradually breaks down.</p><p>Second, <code>apt-get</code> manages both user software and system components simultaneously. In my view, <strong>dependency management is a complex system problem</strong>. The chaotic dependency relationships between software packages, with each node in the relationship network frequently updating itself, it&rsquo;s not difficult to conclude that the uncertainty here increases nearly exponentially with the number of packages. There&rsquo;s also an example of this: occasionally seeing developers who use <code>npm</code> complaining about <code>node_modules</code> is particularly interesting.</p><p>Here I clearly distinguish between <strong>user software</strong> and <strong>system components</strong>. System components are few in number, change slowly and are stable, and are mostly depended upon - these characteristics perfectly fit package management. User software, on the other hand, is numerous and diverse, changes rapidly and can die at any time, depends on a large number of libraries - this completely steps on package management&rsquo;s landmines. When we try to integrate these two types of packages together, system components being &ldquo;blown up&rdquo; by some user software is to be expected.</p><p>Secondly, it introduces <strong>sandboxing</strong>. There&rsquo;s no need to say much about what problem this solves. In recent years, both Microsoft and Google have been tightening permissions for user software on their respective systems. Users in China are also slowly becoming aware of privacy and security-related concepts.</p><p>Then there&rsquo;s <strong>unification</strong>. As everyone knows, Linux distributions are quite <strong>fragmented</strong>, even more fragmented than Android. I personally switched from <code>arch</code> to <code>debian</code> to <code>opensuse</code> back to <code>debian</code> and finally settled on <code>fedora</code>, and there are countless niche within niche distributions, while these distributions also have version fragmentation similar to Android. Then you also have to factor in desktop environment fragmentation: <code>gnome/kde/cosmic/xfce/lxqt/...</code>. This fragmentation brings a terrible user experience and has discouraged many developers.</p><p>Finally, from the developer&rsquo;s perspective, there have always been two contradictory points.</p><p>First is the difference in system environment between developers and users, which is a fragmentation problem, but it has given Linux users a bad reputation, such as the common saying: <strong>the smallest number of users, but the most issues reported</strong>.</p><p>Second is with distributions, where the core contradiction lies in different requirements for dependency versions between distributions and developers. Distributions need a certain component to stay at the latest version or not update major versions, only updating security patches. Developers have one requirement: use the same dependency versions as the development environment.</p><h2 id=how-does-flatpak-solve-these>How Does Flatpak Solve These<a hidden class=anchor aria-hidden=true href=#how-does-flatpak-solve-these>#</a></h2><h3 id=runtime><a href=https://freedesktop-sdk.io/>Runtime</a><a hidden class=anchor aria-hidden=true href=#runtime>#</a></h3><p><a href=https://s33.postimg.cc/fpqffim4f/diagram.png data-dimbox data-dimbox-caption=img><img alt=img height=% loading=lazy src=https://s33.postimg.cc/fpqffim4f/diagram.png width=%></a></p><ul><li>The runtime encompasses most common base libraries, such as glibc, libstdc++, libcurl, xorg suite, wayland suite, etc.</li><li>Version numbers like 23.08/24.08, with one major update per year to introduce breaking changes, while regular maintenance ensures <a href="https://gitlab.com/freedesktop-sdk/freedesktop-sdk/-/blob/release/24.08/utils/check-abi.py?ref_type=heads">ABI compatibility</a>.</li><li>Libraries not in the runtime are bundled by the software itself, and libraries with the same name prioritize loading the bundled version. Similar to the Win/Android approach.</li><li>Runtime is divided into <strong>Platform</strong> and <strong>SDK</strong>. Simply put, Platform is derived from SDK by removing header files, static libraries, compilation toolchains, etc.</li></ul><p>Now that the basic situation is explained, some people may wonder why not directly use the host&rsquo;s libraries, which would save more space.</p><p><strong>Decoupling from the system</strong> - not depending on or assuming the host system&rsquo;s libraries, so that even an ancient Debian oldstable can use the latest libraries and software. This also greatly solves the distribution <strong>fragmentation</strong> problem.</p><p>For developers, a determined runtime environment, the freedom to decide dependency library versions, allows more energy to be focused on developing software.</p><h3 id=bubblewrap-isolation><a href=https://github.com/containers/bubblewrap>bubblewrap Isolation</a><a hidden class=anchor aria-hidden=true href=#bubblewrap-isolation>#</a></h3><p>An unprivileged sandbox implemented through <a href=https://en.wikipedia.org/wiki/Linux_namespaces>Linux namespaces</a>, details can be found on the project homepage.</p><p>It ensures that, with specified limited permissions, flatpak applications are isolated from the host environment.</p><h3 id=portal-xdp><a href=https://github.com/flatpak/xdg-desktop-portal>Portal (xdp)</a><a hidden class=anchor aria-hidden=true href=#portal-xdp>#</a></h3><p>After isolating the host environment, we need a set of verified IPC interfaces to manage some sensitive host resources.</p><p>You can refer to Android permissions, though Android is based on binder, while xdp is based on dbus.</p><p>What&rsquo;s quite interesting is that xdp has indirectly unified the chaotic desktop environment interfaces of Linux desktop. <code>qt/gtk/electron/...</code> have all now adapted to xdp.</p><h2 id=is-flatpak-a-package-manager>Is Flatpak a Package Manager<a hidden class=anchor aria-hidden=true href=#is-flatpak-a-package-manager>#</a></h2><p>Back to the article&rsquo;s title, is Flatpak a package management tool? I don&rsquo;t think so.</p><p>Our definition of package management is generally limited to software within Linux distributions that satisfies certain functions. Flatpak has many similarities with these software, but the approach is completely different. Most importantly, Flatpak cannot replace traditional package management; it&rsquo;s more of a supplement, returning package management to the role of &ldquo;managing system software packages&rdquo;. Flatpak packages have very coarse granularity and unusually shallow dependency relationships, unable to build/operate fine components in distributions. For example, freedesktop sdk itself is not built through Flatpak but through <a href=https://github.com/apache/buildstream>BuildStream</a>.</p><p>However, this is actually an open question, and readers can judge for themselves.</p><p>Or look at it from another angle, for example, is Android&rsquo;s package installer a package manager?</p><h2 id=flatpak-tips-and-technical-details>Flatpak Tips and Technical Details<a hidden class=anchor aria-hidden=true href=#flatpak-tips-and-technical-details>#</a></h2><h3 id=runtime-1><a href=https://freedesktop-sdk.io/>Runtime</a><a hidden class=anchor aria-hidden=true href=#runtime-1>#</a></h3><h4 id=app><code>/app</code><a hidden class=anchor aria-hidden=true href=#app>#</a></h4><p>Let&rsquo;s go into the runtime and take a specific look</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ flatpak run --command<span class=o>=</span>bash org.freedesktop.Sdk//24.08
</span></span><span class=line><span class=cl><span class=o>[</span>üì¶ org.freedesktop.Sdk ~<span class=o>]</span>$ ls /
</span></span><span class=line><span class=cl>app  bin  dev  etc  lib  lib64  proc  run  sbin  sys  tmp  usr  var
</span></span><span class=line><span class=cl><span class=o>[</span>üì¶ org.freedesktop.Sdk ~<span class=o>]</span>$ cat /etc/ld.so.conf
</span></span><span class=line><span class=cl>include /run/flatpak/ld.so.conf.d/app-*.conf
</span></span><span class=line><span class=cl>include /app/etc/ld.so.conf
</span></span><span class=line><span class=cl>/app/lib
</span></span><span class=line><span class=cl>include /run/flatpak/ld.so.conf.d/runtime-*.conf
</span></span><span class=line><span class=cl><span class=o>[</span>üì¶ org.freedesktop.Sdk ~<span class=o>]</span>$ ldd /usr/bin/ls
</span></span><span class=line><span class=cl>        linux-vdso.so.1 <span class=o>(</span>0x00007f4737637000<span class=o>)</span>
</span></span><span class=line><span class=cl>        libselinux.so.1 <span class=o>=</span>&gt; /usr/lib/x86_64-linux-gnu/libselinux.so.1 <span class=o>(</span>0x00007f47375bd000<span class=o>)</span>
</span></span><span class=line><span class=cl>        libc.so.6 <span class=o>=</span>&gt; /usr/lib/x86_64-linux-gnu/libc.so.6 <span class=o>(</span>0x00007f47373be000<span class=o>)</span>
</span></span><span class=line><span class=cl>        libpcre2-8.so.0 <span class=o>=</span>&gt; /usr/lib/x86_64-linux-gnu/libpcre2-8.so.0 <span class=o>(</span>0x00007f473731d000<span class=o>)</span>
</span></span><span class=line><span class=cl>        /lib64/ld-linux-x86-64.so.2 <span class=o>(</span>0x00007f4737639000<span class=o>)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>üì¶ org.freedesktop.Sdk ~<span class=o>]</span>$ <span class=nb>echo</span> <span class=nv>$PATH</span>
</span></span><span class=line><span class=cl>/app/bin:/usr/bin
</span></span></code></pre></div><p>You can see that this is actually equivalent to a minimal distribution following <strong>FHS</strong>.</p><ul><li><code>/app</code>
As the Prefix for each software, during compilation and packaging, only this directory is writable.</li><li><code>/app/lib</code>
Where software places bundled libraries</li><li><code>/app/bin</code>
In the container&rsquo;s PATH environment variable by default, the software&rsquo;s startup program needs to be installed/linked here</li></ul><h4 id=host-share>host share<a hidden class=anchor aria-hidden=true href=#host-share>#</a></h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>üì¶ org.freedesktop.Sdk ~<span class=o>]</span>$ <span class=nb>echo</span> <span class=nv>$XDG_DATA_DIRS</span>
</span></span><span class=line><span class=cl>/app/share:/usr/share:/usr/share/runtime/share:/run/host/user-share:/run/host/share
</span></span><span class=line><span class=cl><span class=o>[</span>üì¶ org.freedesktop.Sdk ~<span class=o>]</span>$ cat /etc/fonts/conf.d/50-flatpak.conf
</span></span><span class=line><span class=cl>&lt;?xml <span class=nv>version</span><span class=o>=</span><span class=s2>&#34;1.0&#34;</span>?&gt;
</span></span><span class=line><span class=cl>&lt;!DOCTYPE fontconfig SYSTEM <span class=s2>&#34;fonts.dtd&#34;</span>&gt;
</span></span><span class=line><span class=cl>&lt;fontconfig&gt;
</span></span><span class=line><span class=cl>        &lt;!-- This has to be first so it is written <span class=k>while</span> building the runtime --&gt;
</span></span><span class=line><span class=cl>        &lt;cachedir&gt;/usr/cache/fontconfig&lt;/cachedir&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        &lt;dir&gt;/app/share/fonts&lt;/dir&gt;
</span></span><span class=line><span class=cl>        &lt;!-- Then this so it is written when building the app --&gt;
</span></span><span class=line><span class=cl>        &lt;cachedir&gt;/app/cache/fontconfig&lt;/cachedir&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        &lt;include <span class=nv>ignore_missing</span><span class=o>=</span><span class=s2>&#34;yes&#34;</span>&gt;/app/etc/fonts/local.conf&lt;/include&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        &lt;dir&gt;/run/host/fonts&lt;/dir&gt;
</span></span><span class=line><span class=cl>        &lt;dir&gt;/run/host/local-fonts&lt;/dir&gt;
</span></span><span class=line><span class=cl>        &lt;dir&gt;/run/host/user-fonts&lt;/dir&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        &lt;!-- This is duplicated from the general config because we want to write there
</span></span><span class=line><span class=cl>             before the /run dirs, in <span class=k>case</span> they are ever writable, like e.g with old
</span></span><span class=line><span class=cl>             versions of flatpak. --&gt;
</span></span><span class=line><span class=cl>        &lt;cachedir <span class=nv>prefix</span><span class=o>=</span><span class=s2>&#34;xdg&#34;</span>&gt;fontconfig&lt;/cachedir&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        &lt;cachedir&gt;/run/host/fonts-cache&lt;/cachedir&gt;
</span></span><span class=line><span class=cl>        &lt;cachedir&gt;/run/host/user-fonts-cache&lt;/cachedir&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        &lt;include&gt;/run/host/font-dirs.xml&lt;/include&gt;
</span></span><span class=line><span class=cl>&lt;/fontconfig&gt;
</span></span></code></pre></div><ul><li><p><code>/run/host/share/icons</code>
Corresponds to <code>/usr/share/icons</code></p></li><li><p><code>/run/host/user-share/icons</code>
Corresponds to <code>${XDG_DATA_HOME}/icons</code></p></li><li><p><code>/run/host/fonts</code>
Corresponds to <code>/usr/share/fonts</code></p></li><li><p><code>/run/host/user-fonts</code>
Corresponds to <code>${XDG_DATA_HOME}/fonts</code></p></li></ul><h3 id=global-permissions>Global Permissions<a hidden class=anchor aria-hidden=true href=#global-permissions>#</a></h3><p>Flatpak can preset unified permissions for all applications.
This is quite useful, for example, I have a folder that no application should see, even with <code>host</code> permission.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>$ flatpak override --user --filesystem<span class=o>=</span><span class=s1>&#39;xdg-config/fontconfig:ro&#39;</span>
</span></span><span class=line><span class=cl>$ cat ~/.local/share/flatpak/overrides/global
</span></span><span class=line><span class=cl><span class=o>[</span>Context<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>filesystems</span><span class=o>=</span>xdg-config/gtk-3.0:ro<span class=p>;</span>!xdg-run/keyring<span class=p>;</span>/nix:ro<span class=p>;</span>xdg-config/fontconfig:ro<span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Session Bus Policy<span class=o>]</span>
</span></span><span class=line><span class=cl>com.canonical.AppMenu.Registrar<span class=o>=</span>talk
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Environment<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>MOZ_ENABLE_WAYLAND</span><span class=o>=</span><span class=m>1</span>
</span></span></code></pre></div><h4 id=priority>Priority<a hidden class=anchor aria-hidden=true href=#priority>#</a></h4><p>The application&rsquo;s own permission configuration has first priority, followed by global permissions.
However, <code>filesystem</code> permissions are a bit different, as they have their own priority. For example, <code>host/home</code> has lower priority than general paths. Roughly speaking, <code>filesystem</code>&rsquo;s own priority is satisfied first before considering others.</p><h3 id=system-wide-and-per-user>system-wide and per-user<a hidden class=anchor aria-hidden=true href=#system-wide-and-per-user>#</a></h3><p>Similar to Windows&rsquo; install for all users vs install just for me.
Note that these two are completely independent, and if both are used, two copies of <code>runtime</code> are needed.
I recommend using <code>per-user</code>, but if it&rsquo;s a shared home computer, <code>system-wide</code> is recommended.</p><h4 id=system-wide>system-wide<a hidden class=anchor aria-hidden=true href=#system-wide>#</a></h4><p>Installation location: <code>/var/lib/flatpak/</code>
Requires permissions to execute commands, distributions basically all have <a href=https://github.com/flatpak/flatpak/blob/1.15.91/system-helper/org.freedesktop.Flatpak.rules.in>polkit rule</a> installed, of course you can also use <code>sudo</code></p><h4 id=per-user>per-user<a hidden class=anchor aria-hidden=true href=#per-user>#</a></h4><p>Installation location: <code>$HOME/.local/share/flatpak/</code>
Requires using the <code>--user</code> flag, added after the command</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://blog.bluempty.com/en/tags/technology/>Technology</a></li><li><a href=https://blog.bluempty.com/en/tags/linux/>Linux</a></li></ul><nav class=paginav><a class=prev href=https://blog.bluempty.com/en/post/cpp-rust-trait/><span class=title>¬´ Prev</span><br><span>Simulating Rust Trait in C++</span></a></nav></footer></article></main><footer class=footer><span>¬© 2025 <a href=https://blog.bluempty.com>Bluempty</a> ¬∑ <a href=https://creativecommons.org/licenses/by-nc-sa/4.0/>CC BY-NC-SA 4.0</a></span> ¬∑
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=/js/dimbox.min.js></script><script>let menu=document.getElementById("menu");if(menu){const e=localStorage.getItem("menu-scroll-position");e&&(menu.scrollLeft=parseInt(e,10)),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}}document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{const e=document.querySelector("html");e.dataset.theme==="dark"?(e.dataset.theme="light",localStorage.setItem("pref-theme","light")):(e.dataset.theme="dark",localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>